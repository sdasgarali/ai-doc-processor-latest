# ===========================================
# ISO 27001 Risk Register
# ===========================================
# Living document tracking information security risks.
# Updated automatically and reviewed quarterly.
# ===========================================

metadata:
  version: "1.0"
  framework: "ISO 27001:2022"
  last_review: "2025-01-01"
  next_review: "2025-04-01"
  owner: "Security Team"
  review_frequency: "Quarterly"

# Risk scoring matrix
risk_matrix:
  likelihood:
    - name: "Very Low"
      value: 1
    - name: "Low"
      value: 2
    - name: "Medium"
      value: 3
    - name: "High"
      value: 4
    - name: "Very High"
      value: 5
  impact:
    - name: "Negligible"
      value: 1
    - name: "Minor"
      value: 2
    - name: "Moderate"
      value: 3
    - name: "Major"
      value: 4
    - name: "Severe"
      value: 5
  risk_levels:
    - name: "Low"
      range: "1-6"
      color: "#28a745"
    - name: "Medium"
      range: "7-14"
      color: "#ffc107"
    - name: "High"
      range: "15-25"
      color: "#dc3545"

# ===========================================
# Risk Register Entries
# ===========================================
risks:
  # -----------------------------------------
  # R-001: Unauthorized Code Changes
  # -----------------------------------------
  - id: "R-001"
    title: "Unauthorized Code Changes"
    category: "Change Management"
    asset: "CI/CD Pipeline"
    threat: "Unauthorized or malicious code changes reaching production"
    vulnerability: "Insufficient access controls or review processes"
    likelihood: "Low"
    likelihood_score: 2
    impact: "High"
    impact_score: 4
    risk_score: 8
    risk_level: "Medium"
    controls:
      - "PR approval requirements (CODEOWNERS)"
      - "CI pipeline enforcement (fail-closed)"
      - "AI governance rules validation"
      - "Branch protection rules"
    treatment: "Mitigate"
    status: "Mitigated"
    residual_risk: "Low"
    owner: "DevOps Team"
    review_date: "2025-01-01"
    notes: "Controls verified effective via automated testing"

  # -----------------------------------------
  # R-002: Incorrect AI Automated Changes
  # -----------------------------------------
  - id: "R-002"
    title: "Incorrect AI Automated Changes"
    category: "Automation"
    asset: "AI Self-Healing Agent"
    threat: "AI introduces bugs or security issues via auto-fixes"
    vulnerability: "Over-reliance on AI without human oversight"
    likelihood: "Medium"
    likelihood_score: 3
    impact: "Medium"
    impact_score: 3
    risk_score: 9
    risk_level: "Medium"
    controls:
      - "Risk-based auto-merge (LOW risk only)"
      - "Maximum 2 self-heal commits per PR"
      - "Human approval required for elevated risks"
      - "All AI actions logged for audit"
    treatment: "Mitigate"
    status: "Mitigated"
    residual_risk: "Low"
    owner: "Security Team"
    review_date: "2025-01-01"
    notes: "Policy engine validates all auto-merge decisions"

  # -----------------------------------------
  # R-003: Credential Leakage
  # -----------------------------------------
  - id: "R-003"
    title: "Credential Leakage"
    category: "Data Protection"
    asset: "API Keys and Secrets"
    threat: "Credentials exposed in code, logs, or version control"
    vulnerability: "Accidental commit of secrets"
    likelihood: "Low"
    likelihood_score: 2
    impact: "Critical"
    impact_score: 5
    risk_score: 10
    risk_level: "Medium"
    controls:
      - "GitHub Secrets for sensitive values"
      - "No hardcoded secrets policy"
      - "Pre-commit hooks for secret detection"
      - ".gitignore for sensitive files"
    treatment: "Mitigate"
    status: "Mitigated"
    residual_risk: "Low"
    owner: "Security Team"
    review_date: "2025-01-01"
    notes: "Consider adding git-secrets scanning"

  # -----------------------------------------
  # R-004: Supply Chain Attack
  # -----------------------------------------
  - id: "R-004"
    title: "Supply Chain Attack"
    category: "Third Party"
    asset: "Dependencies"
    threat: "Malicious code introduced via compromised dependencies"
    vulnerability: "Unvetted or outdated dependencies"
    likelihood: "Low"
    likelihood_score: 2
    impact: "High"
    impact_score: 4
    risk_score: 8
    risk_level: "Medium"
    controls:
      - "pip-audit vulnerability scanning"
      - "Safety database checks"
      - "Dependency pinning"
      - "Weekly security scans"
    treatment: "Mitigate"
    status: "Mitigated"
    residual_risk: "Low"
    owner: "DevOps Team"
    review_date: "2025-01-01"
    notes: "Automated scanning catches known vulnerabilities"

  # -----------------------------------------
  # R-005: CI/CD Pipeline Compromise
  # -----------------------------------------
  - id: "R-005"
    title: "CI/CD Pipeline Compromise"
    category: "Infrastructure"
    asset: "GitHub Actions Workflows"
    threat: "Attacker modifies CI/CD to inject malicious code"
    vulnerability: "Insufficient protection of workflow files"
    likelihood: "Very Low"
    likelihood_score: 1
    impact: "Severe"
    impact_score: 5
    risk_score: 5
    risk_level: "Low"
    controls:
      - "Workflow changes blocked from auto-merge"
      - "CODEOWNERS requires security team review"
      - "AI rules prevent CI weakening"
      - "Governance controller monitors drift"
    treatment: "Mitigate"
    status: "Mitigated"
    residual_risk: "Very Low"
    owner: "Security Team"
    review_date: "2025-01-01"
    notes: "Multiple layers of protection in place"

  # -----------------------------------------
  # R-006: Insider Threat
  # -----------------------------------------
  - id: "R-006"
    title: "Insider Threat"
    category: "Personnel"
    asset: "Codebase"
    threat: "Malicious insider bypasses controls"
    vulnerability: "Trusted users with elevated access"
    likelihood: "Very Low"
    likelihood_score: 1
    impact: "High"
    impact_score: 4
    risk_score: 4
    risk_level: "Low"
    controls:
      - "Mandatory PR reviews (no self-merge)"
      - "Audit trail of all changes"
      - "AI monitors for rule violations"
      - "Separation of duties"
    treatment: "Accept"
    status: "Accepted"
    residual_risk: "Low"
    owner: "Management"
    review_date: "2025-01-01"
    notes: "Accepted as likelihood is very low with controls"

  # -----------------------------------------
  # R-007: Service Availability
  # -----------------------------------------
  - id: "R-007"
    title: "Service Availability Loss"
    category: "Availability"
    asset: "CI/CD Platform"
    threat: "GitHub Actions or dependencies become unavailable"
    vulnerability: "Dependency on third-party services"
    likelihood: "Low"
    likelihood_score: 2
    impact: "Moderate"
    impact_score: 3
    risk_score: 6
    risk_level: "Low"
    controls:
      - "Local LLM fallback (Ollama)"
      - "Self-contained governance rules"
      - "Fail-open for non-critical AI steps"
    treatment: "Accept"
    status: "Accepted"
    residual_risk: "Low"
    owner: "DevOps Team"
    review_date: "2025-01-01"
    notes: "Impact limited to development velocity, not production"

# ===========================================
# Risk Summary
# ===========================================
summary:
  total_risks: 7
  by_level:
    high: 0
    medium: 4
    low: 3
  by_status:
    mitigated: 5
    accepted: 2
    open: 0
  last_updated: "2025-01-01"
