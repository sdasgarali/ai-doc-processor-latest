# ===========================================
# HITRUST CSF Control Mapping
# ===========================================
# Maps HITRUST Common Security Framework (CSF) controls
# to CI/CD and AI governance implementations.
# Reference: HITRUST CSF v11
# ===========================================

metadata:
  version: "1.0"
  last_updated: "2025-01-01"
  framework: "HITRUST CSF v11"
  owner: "Compliance Team"
  scope: "CI/CD pipelines and AI-assisted development"

# ===========================================
# Summary
# ===========================================
summary:
  total_controls: 25
  implemented: 23
  partially_implemented: 2
  not_applicable: 0
  coverage_percentage: 92

# ===========================================
# Control Domains
# ===========================================

# ===========================================
# 01 - Information Security Management Program
# ===========================================
information_security_management:
  "01.a":
    control_id: "01.a"
    title: "Information Security Management Program"
    description: "Establish information security management program"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "AI governance rules document"
      - "Auto-merge policy"
      - "Risk register"
    evidence:
      - path: ".ai/CLAUDE_RULES.md"
        description: "Security management documentation"
      - path: ".ai/AUTO_MERGE_POLICY.yaml"
        description: "Policy documentation"
    maturity_level: "Managed"

  "01.b":
    control_id: "01.b"
    title: "Risk Assessment"
    description: "Conduct risk assessments"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "ISO 27001 risk register"
      - "HIPAA risk assessment"
      - "AI risk classification"
    evidence:
      - path: ".ai/COMPLIANCE/ISO_RISK_REGISTER.yaml"
        description: "Risk register"
      - path: ".ai/COMPLIANCE/HIPAA/HIPAA_RISK_ASSESSMENT.yaml"
        description: "HIPAA risk assessment"
    maturity_level: "Measured"

# ===========================================
# 02 - Access Control
# ===========================================
access_control:
  "02.a":
    control_id: "02.a"
    title: "Access Control Policy"
    description: "Establish access control policy"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "GitHub RBAC"
      - "CODEOWNERS file"
      - "Branch protection rules"
    evidence:
      - path: ".github/CODEOWNERS"
        description: "Access control rules"
    maturity_level: "Managed"

  "02.b":
    control_id: "02.b"
    title: "User Access Management"
    description: "Manage user access rights"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "GitHub organization membership"
      - "Team-based permissions"
      - "Required PR approvals"
    evidence:
      - note: "GitHub organization settings"
    maturity_level: "Managed"

  "02.c":
    control_id: "02.c"
    title: "User Responsibilities"
    description: "Define user responsibilities for access"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "CODEOWNERS defines reviewers"
      - "AI governance rules"
    evidence:
      - path: ".github/CODEOWNERS"
        description: "Ownership and responsibility"
    maturity_level: "Managed"

  "02.d":
    control_id: "02.d"
    title: "Network Access Control"
    description: "Control network access"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "GitHub authentication"
      - "HTTPS enforcement"
      - "API token scoping"
    evidence:
      - note: "GitHub enforces HTTPS"
    maturity_level: "Managed"

# ===========================================
# 03 - Human Resources Security
# ===========================================
human_resources:
  "03.a":
    control_id: "03.a"
    title: "Security Awareness Training"
    description: "Provide security awareness training"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "AI review provides security feedback"
      - "Security scan results educate developers"
      - "PR comments with security guidance"
    evidence:
      - path: "scripts/pr_commenter.py"
        description: "Security feedback mechanism"
    maturity_level: "Managed"

# ===========================================
# 04 - Asset Management
# ===========================================
asset_management:
  "04.a":
    control_id: "04.a"
    title: "Inventory of Assets"
    description: "Maintain inventory of information assets"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Git repository is asset inventory"
      - "pyproject.toml lists dependencies"
    evidence:
      - path: "pyproject.toml"
        description: "Dependency inventory"
    maturity_level: "Managed"

  "04.b":
    control_id: "04.b"
    title: "Acceptable Use"
    description: "Define acceptable use of assets"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "AI governance rules"
      - "Auto-merge policy"
    evidence:
      - path: ".ai/CLAUDE_RULES.md"
        description: "Acceptable use policy"
    maturity_level: "Managed"

# ===========================================
# 05 - Physical and Environmental Security
# ===========================================
physical_security:
  "05.a":
    control_id: "05.a"
    title: "Secure Areas"
    description: "Secure physical areas"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Cloud infrastructure provider"
    evidence:
      - note: "Reference cloud provider SOC-2 report"
    maturity_level: "Managed"
    note: "Cloud provider responsibility"

# ===========================================
# 06 - Communications and Operations Management
# ===========================================
operations_management:
  "06.a":
    control_id: "06.a"
    title: "Operational Procedures"
    description: "Document operational procedures"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "CI/CD workflows document procedures"
      - "AI governance rules"
    evidence:
      - path: ".github/workflows/ci.yml"
        description: "Operational procedures"
    maturity_level: "Managed"

  "06.b":
    control_id: "06.b"
    title: "Change Management"
    description: "Manage changes to information systems"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "PR-based change management"
      - "CI enforcement"
      - "Risk-based approval"
    evidence:
      - path: ".github/workflows/ci.yml"
        description: "Change management workflow"
      - path: ".ai/AUTO_MERGE_POLICY.yaml"
        description: "Change approval policy"
    maturity_level: "Measured"

  "06.c":
    control_id: "06.c"
    title: "Separation of Duties"
    description: "Separate duties to reduce fraud risk"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Required PR approvals (not self-approve)"
      - "CODEOWNERS enforcement"
      - "AI cannot approve its own changes"
    evidence:
      - path: ".ai/CLAUDE_RULES.md"
        description: "Separation of duties"
    maturity_level: "Managed"

  "06.d":
    control_id: "06.d"
    title: "Malware Protection"
    description: "Protect against malware"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Security scanning (Bandit)"
      - "Dependency vulnerability scanning"
      - "Pre-commit hooks"
    evidence:
      - path: ".github/workflows/security.yml"
        description: "Malware/vulnerability scanning"
    maturity_level: "Measured"

  "06.e":
    control_id: "06.e"
    title: "Backup"
    description: "Implement backup procedures"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Git repository is distributed backup"
      - "GitHub cloud hosting"
    evidence:
      - note: "Git distributed version control"
    maturity_level: "Managed"

  "06.f":
    control_id: "06.f"
    title: "Logging and Monitoring"
    description: "Log and monitor system activities"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "CI/CD execution logs"
      - "AI metrics database"
      - "GitHub audit log"
    evidence:
      - path: ".ai/ai_metrics.db"
        description: "Metrics database"
    maturity_level: "Measured"

# ===========================================
# 07 - Information Systems Acquisition
# ===========================================
systems_acquisition:
  "07.a":
    control_id: "07.a"
    title: "Security Requirements"
    description: "Include security requirements in systems"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Security scans in CI pipeline"
      - "Required tests before merge"
    evidence:
      - path: ".github/workflows/ci.yml"
        description: "Security requirements enforcement"
    maturity_level: "Managed"

  "07.b":
    control_id: "07.b"
    title: "Security in Development"
    description: "Implement security in development processes"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Static analysis (Bandit)"
      - "Dependency scanning (pip-audit)"
      - "AI security review"
    evidence:
      - path: ".github/workflows/security.yml"
        description: "Security in development"
    maturity_level: "Measured"

# ===========================================
# 08 - Information Security Incident Management
# ===========================================
incident_management:
  "08.a":
    control_id: "08.a"
    title: "Incident Response"
    description: "Establish incident response procedures"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Automated CI failure detection"
      - "Slack notifications"
      - "Self-healing PR agent"
    evidence:
      - path: "scripts/slack_notifier.py"
        description: "Incident notification"
      - path: "scripts/pr_self_heal.py"
        description: "Automated response"
    maturity_level: "Measured"

  "08.b":
    control_id: "08.b"
    title: "Incident Reporting"
    description: "Report security incidents"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "PR comments document incidents"
      - "Slack notifications"
      - "Metrics database records events"
    evidence:
      - path: "scripts/pr_commenter.py"
        description: "Incident documentation"
    maturity_level: "Managed"

# ===========================================
# 09 - Business Continuity Management
# ===========================================
business_continuity:
  "09.a":
    control_id: "09.a"
    title: "Business Continuity"
    description: "Maintain business continuity"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Local LLM fallback (Ollama)"
      - "Fail-open for non-critical AI"
      - "Production rollback capability"
    evidence:
      - path: "scripts/ai_engine.py"
        description: "Fallback implementation"
    maturity_level: "Managed"

# ===========================================
# 10 - Compliance
# ===========================================
compliance:
  "10.a":
    control_id: "10.a"
    title: "Compliance with Legal Requirements"
    description: "Identify and comply with legal requirements"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "SOC-2 control mapping"
      - "ISO 27001 control mapping"
      - "HIPAA safeguards mapping"
    evidence:
      - path: ".ai/COMPLIANCE/SOC2_MAPPING.yaml"
        description: "SOC-2 compliance"
      - path: ".ai/COMPLIANCE/ISO27001_MAPPING.yaml"
        description: "ISO 27001 compliance"
    maturity_level: "Measured"

  "10.b":
    control_id: "10.b"
    title: "Technical Compliance"
    description: "Ensure technical compliance"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "Automated compliance scoring"
      - "Evidence collection"
    evidence:
      - path: "scripts/compliance_score_engine.py"
        description: "Compliance scoring"
    maturity_level: "Measured"

  "10.c":
    control_id: "10.c"
    title: "Audit Considerations"
    description: "Plan information systems audits"
    requirement_level: "1"
    status: "Partially Implemented"
    implemented_by:
      - "Auditor packet generator"
      - "Evidence export"
    evidence:
      - path: "scripts/generate_auditor_packet.py"
        description: "Audit preparation"
    maturity_level: "Managed"
    gap: "External audit scheduling not automated"

# ===========================================
# AI Governance Controls (Custom Extension)
# ===========================================
ai_governance:
  "AI.01":
    control_id: "AI.01"
    title: "AI Usage Policy"
    description: "Establish AI usage governance"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "AI governance rules"
      - "Risk-based auto-merge"
      - "Human oversight requirements"
    evidence:
      - path: ".ai/CLAUDE_RULES.md"
        description: "AI governance policy"
      - path: ".ai/AUTO_MERGE_POLICY.yaml"
        description: "AI automation policy"
    maturity_level: "Managed"

  "AI.02":
    control_id: "AI.02"
    title: "AI Decision Logging"
    description: "Log and audit AI decisions"
    requirement_level: "1"
    status: "Implemented"
    implemented_by:
      - "AI changelog"
      - "Metrics database"
      - "PR comments"
    evidence:
      - path: ".ai/AI_CHANGELOG.md"
        description: "AI decision log"
      - path: ".ai/ai_metrics.db"
        description: "Metrics database"
    maturity_level: "Measured"
